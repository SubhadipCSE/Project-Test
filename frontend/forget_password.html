<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Forgot Password ‚Äî Teacher Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body
    class="flex-col min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center font-sans"
  >
    <div class="flex-grow flex items-center justify-center w-full">
      <div class="w-full max-w-lg bg-white rounded-xl shadow-lg p-6">
        <header class="mb-4">
          <h1 class="text-2xl font-bold text-blue-700">Forgot Password</h1>
          <p class="text-sm text-gray-600">
            Enter your registered email. We'll send a password reset link if the
            email exists.
          </p>
        </header>

        <form id="forgotForm" class="space-y-4" novalidate>
          <label class="block">
            <span class="text-sm font-medium text-gray-700">Email address</span>
            <input
              id="email"
              name="email"
              type="email"
              placeholder="you@example.com"
              required
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 focus:ring-2 focus:ring-blue-200 focus:border-blue-500"
            />
          </label>

          <div class="flex items-center justify-between">
            <button
              id="sendBtn"
              type="submit"
              class="inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-500 transition"
            >
              <svg
                id="spinner"
                class="w-4 h-4 animate-spin hidden"
                viewBox="0 0 24 24"
                fill="none"
              >
                <circle
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="white"
                  stroke-width="4"
                  stroke-opacity="0.25"
                ></circle>
                <path
                  d="M4 12a8 8 0 018-8"
                  stroke="white"
                  stroke-width="4"
                  stroke-linecap="round"
                ></path>
              </svg>
              Send Reset Link
            </button>

            <a href="login.html" class="text-sm text-blue-600 hover:underline"
              >Back to Login</a
            >
          </div>

          <p id="message" class="text-sm mt-1" aria-live="polite"></p>
        </form>

        <hr class="my-6" />

        <p class="text-xs text-gray-500">
          Note: For security, the server should not reveal whether an email
          exists. A generic success message like "<em
            >If an account with that email exists, we've sent a reset link</em
          >" is recommended.
        </p>
      </div>
    </div>

    <!-- Footer -->
    <footer
      class="bg-gradient-to-r from-blue-700 via-indigo-700 to-purple-800 text-white w-full mt-8"
    >
      <div class="max-w-7xl mx-auto px-6 py-12 grid md:grid-cols-4 gap-10">
        <!-- Logo / About -->
        <div>
          <div class="flex items-center gap-3 mb-4">
            <img
              src="logo.jpg"
              alt="Logo"
              class="w-12 h-12 rounded-full border-2 border-white"
            />
            <h2 class="text-2xl font-bold">DITS</h2>
          </div>
          <p class="text-gray-200 text-sm leading-relaxed">
            Dreams of Indian Theological Seminary is dedicated to excellence in
            education, spiritual growth, and community service, empowering the
            next generation with knowledge and values.
          </p>
        </div>

        <!-- Quick Links -->
        <div>
          <h3 class="text-xl font-semibold mb-4">Quick Links</h3>
          <ul class="space-y-2 text-sm">
            <li><a href="index.html" class="hover:text-yellow-300 transition">HOME</a></li>
            <li><a href="#" class="hover:text-yellow-300 transition">DEPARTMENT</a></li>
            <li><a href="#" class="hover:text-yellow-300 transition">ADMISSION</a></li>
            <li><a href="about.html" class="hover:text-yellow-300 transition">ABOUT US</a></li>
            <li><a href="#" class="hover:text-yellow-300 transition">GALLERY</a></li>
            <li><a href="student_panel.html" class="hover:text-yellow-300 transition">STUDENTS ZONE</a></li>
          </ul>
        </div>

        <!-- Our Values -->
        <div>
          <h3 class="text-xl font-semibold mb-4">Our Values</h3>
          <ul class="space-y-2 text-sm">
            <li>‚ú® Innovation</li>
            <li>ü§ù Integrity</li>
            <li>üèÜ Excellence</li>
            <li>üåç Community</li>
          </ul>
        </div>

        <!-- Contact -->
        <div>
          <h3 class="text-xl font-semibold mb-4">Contact Us</h3>
          <p class="text-gray-200 text-sm mb-2">
            üìç Banashyamnagar, West Bengal, India
          </p>
          <p class="text-gray-200 text-sm mb-2">üìû +91 74071 25405</p>
          <p class="text-gray-200 text-sm mb-4">‚úâ noastedlife@gmail.com</p>
        </div>
      </div>

      <!-- Bottom Bar -->
      <div class="bg-black/30 text-center py-4 text-sm text-gray-200">
        ¬© 2025 Dreams of Indian Theological Seminary. All Rights Reserved.
      </div>
    </footer>

    <script>
      const form = document.getElementById("forgotForm");
      const emailInput = document.getElementById("email");
      const sendBtn = document.getElementById("sendBtn");
      const spinner = document.getElementById("spinner");
      const message = document.getElementById("message");

      function setLoading(isLoading) {
        if (isLoading) {
          spinner.classList.remove("hidden");
          sendBtn.setAttribute("disabled", "disabled");
          sendBtn.classList.add("opacity-75", "cursor-not-allowed");
        } else {
          spinner.classList.add("hidden");
          sendBtn.removeAttribute("disabled");
          sendBtn.classList.remove("opacity-75", "cursor-not-allowed");
        }
      }

      function showMessage(text, type = "info") {
        message.textContent = text;
        message.className = "text-sm mt-1";
        if (type === "success") message.classList.add("text-green-600");
        if (type === "error") message.classList.add("text-red-600");
        if (type === "info") message.classList.add("text-gray-700");
      }

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const email = emailInput.value.trim();

        if (!email) {
          showMessage("Please enter your email address.", "error");
          emailInput.focus();
          return;
        }

        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          showMessage("Please enter a valid email address.", "error");
          emailInput.focus();
          return;
        }

        setLoading(true);
        showMessage("");

        try {
          const res = await fetch("/api/auth/forgot-password", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email }),
          });

          if (res.ok) {
            const data = await res.json().catch(() => ({}));
            showMessage(
              data.message ||
                "If an account with that email exists, a reset link has been sent.",
              "success"
            );
          } else {
            const err = await res.json().catch(() => ({}));
            const errMsg =
              err.error ||
              err.message ||
              "Unable to send reset email. Please try again later.";
            showMessage(errMsg, "error");
          }
        } catch (error) {
          console.error(error);
          showMessage(
            "Network error ‚Äî please check your connection and try again.",
            "error"
          );
        } finally {
          setLoading(false);
        }
      });
    </script>
  </body>
</html>
